{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Control Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
    <a class="navbar-brand fw-bold" href="{% url 'create_student' %}">KAFIL AL YATIM</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
            <li class="nav-item">
                <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="{% url 'create_student' %}">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'mark_attendance' %}active{% endif %}" href="{% url 'mark_attendance' %}">Mark Attendance</a>
            </li>
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'subscription_summary' %}active{% endif %}" href="{% url 'subscription_summary' %}">Subscription Summary</a>
            </li>
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'teacher_paycheck' %}active{% endif %}" href="{% url 'teacher_paycheck' %}">Teachers Paycheck</a>
            </li>

            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'control_panel' %}active{% endif %}" href="{% url 'control_panel' %}">Control Panel</a>
            </li>
        </ul>
    </div>
</nav>


<div class="container py-5">
    <h1 class="mb-4 text-center">üìä School Control Panel</h1>

    <div class="row g-4">

        <!-- Study Levels -->
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    Study Levels / ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑÿØÿ±ÿßÿ≥Ÿäÿ©
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                        <tr>
                            <th>Level</th>
                            <th>Specialty</th>
                            <th>School</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for level in study_levels %}
                            <tr>
                                <td>{{ level.level }}</td>
                                <td>{{ level.specialty }}</td>
                                <td>{{ level.school }}</td>
                                <td>
                                    <a href="{% url 'level_edit' level.pk %}">‚úèÔ∏è Edit</a>
                                    <a href="{% url 'level_delete' level.pk %}" onclick="return confirm('Delete this level?')">üóëÔ∏è Delete</a>

                                </td>
                            </tr>
                        {% empty %}
                            <tr><td colspan="3">No study levels yet</td></tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <a href="{% url 'create_study_level' %}" class="btn btn-sm btn-primary">+ Add Study Level</a>
                </div>
            </div>
        </div>

        <!-- Classes -->
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                    Classes / ÿßŸÑŸÖŸàÿßÿØ
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Level</th>
                            <th>Teacher</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for cls in classes %}
                            <tr>
                                <td>{{ cls.name }}</td>
                                <td>{{ cls.level }}</td>
                                <td>{{ cls.teacher }}</td>
                                <td>
                                    <a href="{% url 'class_edit' cls.pk %}">‚úèÔ∏è Edit</a>
                                    <a href="{% url 'class_delete' cls.pk %}" onclick="return confirm('Delete this Class?')">üóëÔ∏è Delete</a>

                                </td>
                            </tr>
                        {% empty %}
                            <tr><td colspan="3">No classes yet</td></tr>
                        {% endfor %}

                        </tbody>
                    </table>
                    <a href="{% url 'create_class' %}" class="btn btn-sm btn-success">+ Add Class</a>
                
                </div>
            </div>
        </div>

        <!-- Teachers -->
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-header bg-warning text-dark">
                    Teachers / ÿßŸÑÿ£ÿ≥ÿßÿ™ÿ∞ÿ©
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for teacher in teachers %}
                            <tr>
                                <td>{{ teacher.full_name }}</td>
                                <td>{{ teacher.phone|default:"-" }}</td>
                                <td>       
                                    <a href="{% url 'teacher_edit' teacher.id %}">‚úèÔ∏è Edit</a>
                                    <a href="{% url 'teacher_delete' teacher.id %}" onclick="return confirm('Delete this teacher?')">üóëÔ∏è Delete</a>

                                </td>
                            
                            </tr>
                        {% empty %}
                            <tr><td colspan="2">No teachers yet</td></tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <a href="{% url 'create_teacher' %}" class="btn btn-sm btn-warning">+ Add Teacher</a>
                </div>
            </div>
        </div>

        <!-- Students -->
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-header bg-danger text-white">
                    Students / ÿßŸÑÿ™ŸÑÿßŸÖŸäÿ∞
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Orphan?</th>
                            <th>Subscription</th>
                            <th>Profile</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for student in students %}
                            <tr>
                                <td>{{ student.full_name }}</td>
                                <td>{% if student.is_orphan %} ‚úÖ {% else %} ‚ùå {% endif %}</td>
                                <td>
                                    {% if student.sub_payed %}
                                        {{ student.sub_montant }} DA
                                    {% else %}
                                        ‚ùå Not Paid
                                    {% endif %}
                                </td>
                                <td>
                                    <a href="{% url 'student_profile' student.id %}" class="btn btn-sm btn-outline-danger">View</a>
                                    <a href="{% url 'student_edit' student.id %}">‚úèÔ∏è Edit</a>
                                    <a href="{% url 'delete_student' student.id %}" onclick="return confirm('Delete this student?')">üóëÔ∏è Delete</a>
                                </td>
                            </tr>
                        {% empty %}
                            <tr><td colspan="4">No students yet</td></tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>

</body>
</html>

